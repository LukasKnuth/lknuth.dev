<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/iAWriterQuattro/iAWriterQuattroS-Bold.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/iAWriterQuattro/iAWriterQuattroS-BoldItalic.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/iAWriterQuattro/iAWriterQuattroS-Italic.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/iAWriterQuattro/iAWriterQuattroS-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Saying more than nothing | Lukas Knuth // Developer</title><link rel=canonical href=https://lknuth.dev/writings/saying_more_than_nothing/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Saying more than nothing"><meta property="og:description" content="When to use null and when to rather say something more."><meta property="og:type" content="article"><meta property="og:url" content="https://lknuth.dev/writings/saying_more_than_nothing/"><meta property="article:section" content="writings"><meta property="article:published_time" content="2012-07-23T22:00:00+01:00"><meta property="article:modified_time" content="2012-07-23T22:00:00+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Saying more than nothing"><meta name=twitter:description content="When to use null and when to rather say something more."><link rel=stylesheet href=https://lknuth.dev/css/styles.c80037fe069dacf3e7d215521d1844203a2c7d5d6638afbbbd90798790d40182a5712b247ed5969fa7b0440fd20225fee106d6233729d4fc1e4381fd6b36fd14.css integrity="sha512-yAA3/gadrPPn0hVSHRhEIDosfV1mOK+7vZB5h5DUAYKlcSskftWWn6ewRA/SAiX+4QbWIzcp1PweQ4H9azb9FA=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://lknuth.dev/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><header id=header><a href=https://lknuth.dev/><div id=logo style=background-image:url(https://lknuth.dev/images/logo.png)></div><div id=title><h1>Lukas Knuth // Developer</h1></div></a><div id=nav><ul><li class=icon><a href=# aria-label=Menu><i class="fas fa-bars fa-2x" aria-hidden=true></i></a></li><li><a href=/>Home</a></li><li><a href=/writings>Writings</a></li><li><a href=/about>About</a></li><li><a href=/imprint>Imprint</a></li></ul></div></header><article class=post itemscope itemtype=http://schema.org/BlogPosting><div class=content itemprop=articleBody><p>As I was reading around on StackOverflow, digging through other peoples source code, I spotted multiple methods returning <code>null</code> in a variety of circumstances. I also found rather imaginative ways to handle null-values.</p><p>Although there is nothing wrong with <code>null</code>, the concept of null-pointers seems to be somewhat misunderstood. Let&rsquo;s change that.</p><h2 id=what-are-null-pointers>What are null-pointers?</h2><p><a href=http://en.wikipedia.org/wiki/Null_pointer#Null_pointer>Wikipedia</a> has the following to say:</p><blockquote><p>A null pointer has a value reserved for indicating that <strong>the pointer does not refer to a valid object.</strong></p></blockquote><p>In Java, there are two types of variables: <em>value-types</em> and <em>reference-types</em>. The first group includes the primitive data-types like <code>int</code>, <code>float</code>, <code>char</code> and <code>byte</code>. The second contains objects.</p><p>Since only reference-types can be <code>null</code> (a reference to <em>nothing</em>), it&rsquo;s not possible to set a value-type to <code>null</code>. <strong>Side-Note</strong>: In Java, you can set a <em>value-type</em> to <code>null</code>, by using the appropriate boxing-type (e.g. <code>Integer</code>, which is a <em>reference-type</em>) and setting it to <code>null</code>.</p><p>When invoking a method or accessing a field on an object with a <code>null</code> reference, a <a href=http://docs.oracle.com/javase/6/docs/api/java/lang/NullPointerException.html><code>NullPointerException</code></a> will be thrown.</p><h2 id=when-to-use-null>When to use null</h2><p>A value of <code>null</code> should only be used when effectively saying <em>nothing</em>. For example, it might be important that there is a difference between an empty message (string <code>""</code>), and no message <em>at all</em> (as in the <a href=http://docs.oracle.com/javase/6/docs/api/java/io/BufferedReader.html#readLine%28%29><code>BufferedReader.readLine()</code>-method</a>).</p><p>A more practical example is given in &ldquo;C# in Depth&rdquo; by Jon Skeet, Chapter 4, &ldquo;Saying nothing with nullable types&rdquo;:</p><blockquote><p>[&mldr;] an example might be an e-commerce application where users are looking at their account history. If an order has
been placed but not delivered, there may be a purchase date but no dispatch date [&mldr;]</p></blockquote><p>In those cases, where there is just <em>nothing</em> to say about the value, you should use <code>null</code>.</p><h2 id=the-dangers-of-null>The dangers of null</h2><p>Let&rsquo;s take a look at some common anti-patterns where <code>null</code> is used inappropriately.</p><h3 id=never-use-null-to-indicate-an-error>Never use null to indicate an error</h3><p>Quite often, developers tend to return <code>null</code> when something went wrong in the method. Here is a classic example:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#928374;font-style:italic>// Anti-pattern. DON&#39;T DO THIS!
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span><span style=color:#fe8019>public</span> Foo <span style=color:#fabd2f>readFoo</span><span style=color:#fe8019>(</span>File file<span style=color:#fe8019>){</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>try</span> <span style=color:#fe8019>{</span>
</span></span><span style=display:flex><span>        <span style=color:#928374;font-style:italic>// Try reading the contents from the given file
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        <span style=color:#fe8019>return</span> actualReadData<span style=color:#fe8019>;</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>}</span> <span style=color:#fe8019>catch</span> <span style=color:#fe8019>(</span>IOException e<span style=color:#fe8019>){</span>
</span></span><span style=display:flex><span>        e<span style=color:#fe8019>.</span><span style=color:#b8bb26;font-weight:700>printStackTrace</span><span style=color:#fe8019>();</span>
</span></span><span style=display:flex><span>        <span style=color:#fe8019>return</span> <span style=color:#fe8019>null</span><span style=color:#fe8019>;</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>}</span>
</span></span><span style=display:flex><span><span style=color:#fe8019>}</span>
</span></span></code></pre></div><p>This code will (given that the reading part is actually implemented) read the contents from the passed <code>file</code>-argument, create a new <code>Foo</code>-object and return it. If however the method fails to read the contents from the file, it will return <code>null</code>.</p><p>This pattern is problematic, as it has to be explicitly documented under which circumstances the method returns <code>null</code>. Otherwise, it&rsquo;s unclear what the returned <code>null</code> actually means. Does it mean the file is empty? Does the file not exist? Was the content not parseable?</p><p>Additionally, it might be possible to recover from certain failure cases, but you can&rsquo;t differentiate between them when they all just return <code>null</code> (which only tells you that <em>something</em> went wrong). Last but not least, returning <code>null</code> does not force any handling of the error-condition. All those drawbacks can be overcome by <a href=/2012/catching-practice/#throwing-the-ball>throwing an exception</a> instead.</p><h3 id=yoda-conditions>Yoda Conditions</h3><p>As cool as the name sounds, <a href=http://www.codinghorror.com/blog/2012/07/new-programming-jargon.html>&ldquo;Yoda Conditions&rdquo;</a> are a danger because they completely defeat the purpose of making a value <code>null</code>. Here is an example:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span>String possiblyNull <span style=color:#fe8019>=</span> possiblyReturnsNull<span style=color:#fe8019>();</span>
</span></span><span style=display:flex><span><span style=color:#fe8019>if</span> <span style=color:#fe8019>(</span><span style=color:#b8bb26>&#34;constant&#34;</span><span style=color:#fe8019>.</span><span style=color:#b8bb26;font-weight:700>equals</span><span style=color:#fe8019>(</span>possiblyNull<span style=color:#fe8019>)){</span>
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic>// it equals!
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span><span style=color:#fe8019>}</span> <span style=color:#fe8019>else</span> <span style=color:#fe8019>{</span>
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic>// it doesn&#39;t.
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span><span style=color:#fe8019>}</span>
</span></span></code></pre></div><p>Let&rsquo;s assume that <code>possiblyReturnsNull()</code> does not return <code>null</code> to indicate an error but actually, to return <em>nothing</em>. Using the &ldquo;Yoda Condition&rdquo; avoids a possible <code>NullPointerException</code>. But this also indicates that: &ldquo;null is the same as everything which is not <code>constant</code>&rdquo;.</p><p>Since there&rsquo;s probably a reason why <code>possiblyReturnsNull()</code> returns <code>null</code> instead of an actual value, you should test for this specifically. If it doesn&rsquo;t make a difference if the value is <code>null</code> or anything which is not &ldquo;constant&rdquo;, the decision to return <code>null</code> in this case was probably a design-error.</p><h3 id=never-return-null-for-arrayscollections>Never return null for arrays/collections</h3><p>Let&rsquo;s say you have a function which returns all Unicorn-toys still in stock:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#928374;font-style:italic>// Anti-pattern. DON&#39;T DO THIS!
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span><span style=color:#fe8019>public</span> List<span style=color:#fe8019>&lt;</span>Unicorns<span style=color:#fe8019>&gt;</span> <span style=color:#fabd2f>getUnicorns</span><span style=color:#fe8019>(){</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>if</span> <span style=color:#fe8019>(</span>unicornList<span style=color:#fe8019>.</span><span style=color:#b8bb26;font-weight:700>size</span><span style=color:#fe8019>()</span> <span style=color:#fe8019>==</span> <span style=color:#d3869b>0</span><span style=color:#fe8019>){</span>
</span></span><span style=display:flex><span>        <span style=color:#fe8019>return</span> <span style=color:#fe8019>null</span><span style=color:#fe8019>;</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>}</span>
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span><span style=color:#fe8019>}</span>
</span></span></code></pre></div><p>This case is special because we want to say that there are currently <em>no unicorns</em> in stock. So why is this bad?</p><p>Consider a world in which the hypothetical shop <em>usually</em> always has Unicorn-toys in stock. When the calling code does not explicitly check for a <code>null</code> return value, it might run as expected for years. Until somebody buys up the entire stock and now the shop is crashing.</p><p>So in this case, nothing <em>is</em> the same as empty. Therefor, you can (and should) return an <em>empty</em> array/collection, instead of <code>null</code>:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#928374;font-style:italic>// Return empty arrays/collections instead of null
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span><span style=color:#fe8019>public</span> List<span style=color:#fe8019>&lt;</span>Unicorns<span style=color:#fe8019>&gt;</span> <span style=color:#fabd2f>getUnicorns</span><span style=color:#fe8019>(){</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>if</span> <span style=color:#fe8019>(</span>unicornList<span style=color:#fe8019>.</span><span style=color:#b8bb26;font-weight:700>size</span><span style=color:#fe8019>()</span> <span style=color:#fe8019>==</span> <span style=color:#d3869b>0</span><span style=color:#fe8019>){</span>
</span></span><span style=display:flex><span>        <span style=color:#fe8019>return</span> Collections<span style=color:#fe8019>.</span><span style=color:#b8bb26;font-weight:700>emptyList</span><span style=color:#fe8019>();</span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>}</span>
</span></span><span style=display:flex><span>    <span style=color:#928374;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span><span style=color:#fe8019>}</span>
</span></span></code></pre></div><p>This enables the caller of the method to simply iterate over the returned list, without needing to fear a <code>NullPointerException</code>.</p><p>You don&rsquo;t even need to instantiate a new collection, as the <code>Collections</code>-class provides the methods <code>emptySet()</code>, <code>emptyList()</code> and <code>emptyMap()</code> to return an empty, <a href=/2012/rules-of-immutability/>immutable</a> collection for the given type of collection.</p><h2 id=conclusion>Conclusion</h2><p>To sum it all up:</p><ul><li>Use <code>null</code> when the value is <em>nothing</em></li><li>Don&rsquo;t return <code>null</code> to indicate an error!</li><li>Check for <code>null</code>, if it indicates a different result then &ldquo;not what you&rsquo;re looking for&rdquo;</li><li>Don&rsquo;t return <code>null</code> for empty arrays/collections</li></ul></div></article><footer id=footer><div class=footer-left>Copyright &copy; 2023 Lukas Knuth</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/writings>Writings</a></li><li><a href=/about>About</a></li><li><a href=/imprint>Imprint</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script></html>